<?xml version="1.0"?>
<ruleset name="newrules" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../etc/ruleset_xml_schema.xml">
	<description>
These are new rules for the next release
  </description>


	<rule name="UseCorrectExceptionLogging" message="Use the correct logging statement for logging exceptions" class="net.sourceforge.pmd.rules.XPathRule">
		<description>
		To make sure the full stacktrace is printed out, use the logging statement with 2 arguments: a String and a Throwable.
    </description>
		<properties>
			<property name="xpath">
				<value><![CDATA[
//Block/BlockStatement/Statement
 /StatementExpression/PrimaryExpression
 /PrimaryPrefix
 /Name
  [@Image='_LOG.error']
  [../../PrimarySuffix/Arguments[@ArgumentCount='1']
        ]]></value>
			</property>
		</properties>
		<example><![CDATA[
private static final Log _LOG = LogFactory.getLog( Main.class );
...
try {
}
catch( Exception e ) {
   _LOG.error( e ); //Wrong!
}
catch( OtherException oe ) {
   _LOG.error( oe.getMessage(), oe ); //Correct
}
]]></example>
	</rule>


    <rule  name="AvoidPrintStackTrace"
           message="Avoid printStackTrace(); use a logger call instead."
           class="net.sourceforge.pmd.rules.XPathRule">
           <description>
           Avoid printStackTrace(); use a logger call instead.
           </description>
           <properties>
             <property name="xpath">
             <value>
<![CDATA[
//PrimaryExpression
 [PrimaryPrefix/Name[contains(@Image,'printStackTrace')]]
 [PrimarySuffix[not(boolean(Arguments/ArgumentList/Expression))]]
]]>
             </value>
             </property>
           </properties>
           <priority>3</priority>
           <example>
<![CDATA[
class Foo {
 void bar() {
  try {
   // do something
  } catch (Exception e) {
   e.printStackTrace();
  }
 }
}
]]>
           </example>
    </rule>


</ruleset>
