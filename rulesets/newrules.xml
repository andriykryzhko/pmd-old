<?xml version="1.0"?>

<ruleset name="newrules">
  <description>
These are new rules for the next release
  </description>

    <rule name="InstantiationToGetClass"
          message="Avoid instantiating an object just to call getClass() on it; use the .class public member instead"
          class="net.sourceforge.pmd.rules.XPathRule">
      <description>
Avoid instantiating an object just to call getClass() on it; use the .class public member instead
      </description>
        <example>
    <![CDATA[
class Foo {
 Class c = new String().getClass();
}
    ]]>
        </example>
        <priority>4</priority>
        <properties>
          <property name="xpath">
            <value>
                <![CDATA[
//PrimarySuffix
 [@Image='getClass']
 [parent::PrimaryExpression
  [PrimaryPrefix/AllocationExpression]
  [count(PrimarySuffix) = 2]
 ]
     ]]>
            </value>
          </property>
        </properties>
      </rule>

    <rule name="IdempotentOperationsRule"
          message="Avoid idempotent operations (like assigning a variable to itself)"
          class="net.sourceforge.pmd.rules.IdempotentOperationsRule">
      <description>
      Avoid idempotent operations - they are silly.
      </description>
        <priority>3</priority>

      <example>
      <![CDATA[
    public class Foo {
     public void bar() {
      int x = 2;
      x = x;
     }
    }
      ]]>
      </example>
    </rule>

    <rule
        name="SuspiciousEqualsMethodName"
        message="The method name and parameter number are suspiciously close to equals(Object)"
        class="net.sourceforge.pmd.rules.XPathRule">
        <description>
              The method name and parameter number are suspiciously close to
     equals(Object), which may mean you are trying (and failing) to override the equals(Object)
        method.
        </description>
        <properties>
            <property name="xpath">
                <value>
        <![CDATA[
        //ClassDeclaration//MethodDeclarator
          [@Image = 'equals']
          [count(FormalParameters/*) = 1 ]
          [ not (FormalParameters//Type/Name
                 [@Image = 'Object' or @Image = 'java.lang.Object'])
          ]
        ]]>
                    </value>
                 </property>
              </properties>
        <priority>2</priority>
        <example>
        <![CDATA[
    public class Foo {
         public int equals(Object o) {
         // oops, this probably was supposed to be boolean equals
         }
         public boolean equals(String s) {
         // oops, this probably was supposed to be equals(Object)
         }
    }
        ]]>
        </example>
    </rule>


</ruleset>


