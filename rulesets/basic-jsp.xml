<?xml version="1.0"?>

<ruleset name="Basic JSP rules" language="jsp"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns="../etc/ruleset_xml_schema.xml">
	
	<description>Rules concerning basic JSP guidelines.</description>
	
	<rule name="NoLongScripts"
		message="Avoid having long scripts (e.g. Javascript) inside a JSP file."
		class="net.sourceforge.pmd.rules.XPathRule">
		<description> Scripts should be part of Tag Libraries, rather than part of JSP pages.
			</description>
		<priority>2</priority>
		<properties>
			<property name="xpath">
				<value>
					<![CDATA[ 
// Element [ string:upper-case(@Name)="SCRIPT" and (@EndLine - @BeginLine > 10) ]
				]]>
				</value>
			</property>
		</properties>
		<example>
			<![CDATA[
<HTML>
<BODY>
<!--Java Script-->
<SCRIPT language="JavaScript" type="text/javascript">
<!--
function calcDays(){
  var date1 = document.getElementById('d1').lastChild.data;
  var date2 = document.getElementById('d2').lastChild.data;
  date1 = date1.split("-");
  date2 = date2.split("-");
  var sDate = new Date(date1[0]+"/"+date1[1]+"/"+date1[2]);
  var eDate = new Date(date2[0]+"/"+date2[1]+"/"+date2[2]);
  var daysApart = Math.abs(Math.round((sDate-eDate)/86400000));
  document.getElementById('diffDays').lastChild.data = daysApart;
}

onload=calcDays;
//-->
</SCRIPT>
</BODY>
</HTML>
			]]>
		</example>
	</rule>
	
	<rule name="NoScriptlets" message="Avoid having scriptlets inside a JSP file."
		class="net.sourceforge.pmd.rules.XPathRule">
		<description> Scriptlets should be factored into Tag Libraries or JSP declarations,
			rather than being part of JSP pages. </description>
		<priority>3</priority>
		<properties>
			<property name="xpath">
				<value>
					<![CDATA[ //descendant::*[ 
self::JspScriptlet  or (self::Element and string:upper-case(@Name)="JSP:SCRIPTLET") ]
					]]>
				</value>
			</property>
		</properties>
		<example>
			<![CDATA[ 
<HTML>
<HEAD>
<%
response.setHeader("Pragma", "No-cache");
%>
</HEAD>
	<BODY>
		<jsp:scriptlet>String title = "Hello world!";</jsp:scriptlet>
	</BODY>
</HTML>
					 ]]>
		</example>
	</rule>
	
	<rule name="NoInlineStyleInformation" message="Avoid having style information in JSP files."
		class="net.sourceforge.pmd.jsp.rules.NoInlineStyleInformation">
		<description><![CDATA[ Style information should be put in CSS files, not in JSPs.
			Therefore, don't use <B> or <FONT> tags, or attributes like "align='center'" ]]> </description>
		<priority>3</priority>
		<example>
			<![CDATA[ 
<html><body><p align='center'><b>text</b></p></body></html>
					 ]]>
		</example>
	</rule>
	
	
	<rule name="NoClassAttribute"
		message="Do not use an attribute called 'class'."
		class="net.sourceforge.pmd.rules.XPathRule">
		<description>Do not use an attribute called 'class'. Use "styleclass" for CSS styles.
			</description>
		<priority>2</priority>
		<properties>
			<property name="xpath">
				<value>
					<![CDATA[ //Attribute[ string:upper-case(@Name)="CLASS" ]  ]]>
				</value>
			</property>
		</properties>
		<example>
			<![CDATA[
<HTML> <BODY>
<P class="MajorHeading">Some text</P>
</BODY> </HTML>
			]]>
		</example>
	</rule>
	
	<rule name="NoJspForward"
		message="Do not do a forward from within a JSP file."
		class="net.sourceforge.pmd.rules.XPathRule">
		<description>Do not do a forward from within a JSP file.
			</description>
		<priority>3</priority>
		<properties>
			<property name="xpath">
				<value>
					<![CDATA[ //Element[ @Name="jsp:forward" ]  ]]>
				</value>
			</property>
		</properties>
		<example>
			<![CDATA[
<jsp:forward page='UnderConstruction.jsp'/>
			]]>
		</example>
	</rule>

</ruleset>
