<?xml version="1.0"?>

<document>
  <properties>
    <author email="dpeugh@users.sourceforge.net">David Dixon-Peugh</author>
    <author email="tom@infoether.com">Tom Copeland</author>
    <title>Ant Task</title>
  </properties>

  <body>
    <section name="PMD">
      <subsection name="Description">
        <p>Runs a set of static code analysis rules on some Java source code files and generates a list of problems found.</p>
      </subsection>
      <subsection name="Parameters">
<table border="1" cellpadding="2" cellspacing="0">
  <tr>
    <td valign="top"><b>Attribute</b></td>
    <td valign="top"><b>Description</b></td>
    <td align="center" valign="top"><b>Required</b></td>
  </tr>
  <tr>
    <td valign="top">formatter</td>
    <td valign="top">Specifies the format of and the files to which the report is written.   Formats can be of type 'xml', 'text', or 'html', and filenames can be either relative or absolute.  See example belows.</td>
    <td valign="top" align="center">Yes</td>
  </tr>
  <tr>
    <td valign="top">rulesetfiles</td>
    <td valign="top">A comma delimited list of ruleset files ('rulesets/basic.xml,rulesets/design.xml').  If you write
    your own ruleset files, you can put them on the classpath and plug them in here.</td>
    <td valign="top" align="center">Yes</td>
  </tr>
  <tr>
    <td valign="top">failonerror</td>
    <td valign="top">Whether or not to fail the build if any errors occur while processing the files</td>
    <td valign="top" align="center">No</td>
  </tr>
    <tr>
      <td valign="top">failOnRuleViolation</td>
      <td valign="top">Whether or not to fail the build if PMD finds any problems</td>
      <td valign="top" align="center">No</td>
    </tr>
    <tr>
      <td valign="top">A nested classpath element</td>
       <td valign="top">Also accepts a nested classpath element so you can specify custom ruleset files more easily.  See the example below.</td>
      <td valign="top" align="center">No</td>
    </tr>
  <tr>
    <td valign="top">printToConsole</td>
    <td valign="top">Whether or not to print any problems found to the Ant log/console</td>
    <td valign="top" align="center">No</td>
  </tr>
    <tr>
      <td valign="top">shortFilenames</td>
      <td valign="top">Places truncated filenames in the report.  This can reduce your report file size by 15%-20%.</td>
      <td valign="top" align="center">No</td>
    </tr>
    <tr>
      <td valign="top">verbose</td>
       <td valign="top">Verbose output - names of files processed, rule counts, full stacktraces, etc.</td>
      <td valign="top" align="center">No</td>
    </tr>
</table>

      </subsection>
      <subsection name="Examples">
          <p>Running one ruleset to produce a HTML report</p>
<source>
<![CDATA[
<taskdef name="pmd" classname="net.sourceforge.pmd.ant.PMDTask"/>

<target name="pmd">
    <taskdef name="pmd" classname="net.sourceforge.pmd.ant.PMDTask"/>
    <pmd rulesetfiles="rulesets/imports.xml">
        <formatter type="html" toFile="pmd_report.html"/>
        <fileset dir="C:\j2sdk1.4.1_01\src\java\lang\">
            <include name="**/*.java"/>
        </fileset>
    </pmd>
</target>
]]>
</source>

          <p>Running multiple rulesets to produce an XML report</p>

<source>
<![CDATA[
<taskdef name="pmd" classname="net.sourceforge.pmd.ant.PMDTask"/>

<target name="pmd">
    <taskdef name="pmd" classname="net.sourceforge.pmd.ant.PMDTask"/>
    <pmd rulesetfiles="rulesets/imports.xml,rulesets/unusedcode.xml">
        <formatter type="xml" toFile="c:\pmd_report.xml"/>
        <fileset dir="C:\j2sdk1.4.1_01\src\java\lang\">
            <include name="**/*.java"/>
        </fileset>
    </pmd>
</target>
]]>
</source>

          <p>Using a custom renderer</p>

<source>
<![CDATA[
<taskdef name="pmd" classname="net.sourceforge.pmd.ant.PMDTask"/>

<target name="pmd">
    <pmd rulesetfiles="rulesets/favorites.xml">
        <formatter type="net.sourceforge.pmd.renderers.HTMLRenderer" toFile="foo.html"/>
        <fileset dir="/usr/local/java/src/java/lang/ref">
            <include name="**/*.java"/>
        </fileset>
    </pmd>
</target>
]]>
</source>

          <p>Using a classpath reference in the taskdef</p>

<source>
<![CDATA[
<path id="pmd.classpath">
    <pathelement location="${build}"/>
    <fileset dir="/path/to/my/pmd/lib/">
        <include name="*.jar"/>
    </fileset>
</path>

<taskdef name="pmd" classname="net.sourceforge.pmd.ant.PMDTask" classpathref="classpath.path"/>

<target name="pmd">
      <pmd rulesetfiles="rulesets/favorites.xml">
          <formatter type="net.sourceforge.pmd.renderers.HTMLRenderer" toFile="foo.html"/>
          <fileset dir="/usr/local/java/src/java/lang/ref">
              <include name="**/*.java"/>
          </fileset>
      </pmd>
  </target>
]]>
</source>


      </subsection>
   </section>
 </body>
</document>
